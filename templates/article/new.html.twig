{% extends '@default/base.html.twig' %}

{% block body %}
<section class="section-spacing bg-white">
    <div class="container-narrow">
        <div class="mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900 mb-2">
                {% if (isEditing) %}
                Artikel bearbeiten
                {% else %} 
                Neuen Artikel erstellen
                {% endif %}
            </h1>
        </div>

        {{ form_start(form, {'attr': {'class': 'space-y-6'}}) }}
            <div class="mb-4">
                {{ form_label(form.title, null, {'label_attr': {'class': 'block text-sm font-medium text-slate-700 mb-2'}}) }}
                {{ form_widget(form.title, {'attr': {'class': 'w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500' ~ (form.title.vars.errors|length > 0 ? ' border-red-500' : '')}}) }}
                <div class="mt-1 form-error">
                    {{ form_errors(form.title, {'attr': {'class': 'text-sm text-red-600'}}) }}
                </div>
            </div>

            <div class="mb-4">
                {{ form_label(form.articleType, null, {'label_attr': {'class': 'block text-sm font-medium text-slate-700 mb-2'}}) }}
                {{ form_widget(form.articleType, {'attr': {'class': 'w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500'}}) }}
                {{ form_errors(form.articleType) }}
            </div>

            {# <div class="mb-4">
                {{ form_label(form.author, null, {'label_attr': {'class': 'block text-sm font-medium text-slate-700 mb-2'}}) }}
                {{ form_widget(form.author, {'attr': {'class': 'w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500'}}) }}
                {{ form_errors(form.author) }}
            </div> #}

            <div class="mb-4">
                {{ form_label(form.content, null, {'label_attr': {'class': 'block text-sm font-medium text-slate-700 mb-2'}}) }}
                {{ form_widget(form.content, {'attr': {'class': 'w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500' ~ (form.content.vars.errors|length > 0 ? ' border-red-500' : '')}}) }}
                <div class="mt-1 form-error">
                    {{ form_errors(form.content, {'attr': {'class': 'text-sm text-red-600'}}) }}
                </div>
            </div>

            <div class="flex items-center mb-4">
                {{ form_widget(form.published, {'attr': {'class': 'w-4 h-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500'}}) }}
                {{ form_label(form.published, null, {'label_attr': {'class': 'ml-2 text-sm font-medium text-slate-700'}}) }}
                {{ form_errors(form.published) }}
            </div>



            <div class="mb-4">
                <label class="block text-sm font-medium text-green-800 mb-2">
                    Datei hochladen
                </label>

                <!-- File-Input sichtbar, grün, stilisiert -->
                {{ form_widget(form.uploadFile, {
                    'attr': {
                        'class': 'w-full p-2 border-2 border-green-500 rounded bg-green-50 text-green-800 cursor-pointer hover:bg-green-100'
                    }
                }) }}

                {{ form_errors(form.uploadFile) }}
            </div>

            <script>
                const fileInput = document.getElementById('article_uploadFile');
                const uploadBtn = document.getElementById('upload-btn');
                const fileNameSpan = document.getElementById('file-name');

                // Klick auf den Button öffnet den Dateidialog
                uploadBtn.addEventListener('click', () => fileInput.click());

                // Dateiname aktualisieren
                fileInput.addEventListener('change', () => {
                    if (fileInput.files.length > 0) {
                        fileNameSpan.textContent = fileInput.files[0].name;
                    } else {
                        fileNameSpan.textContent = 'Keine Datei ausgewählt';
                    }
                });
            </script>

            <div class="flex gap-4">
                <button type="submit" class="px-6 py-2 bg-primary-600 text-white font-semibold rounded-lg hover:bg-primary-700 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2">
                    {% if (isEditing) %}
                        Speichern
                    {% else %}
                        Artikel erstellen
                    {% endif %}
                </button>
                <a href="{{ cancel_path }}" class="px-6 py-2 bg-slate-200 text-slate-700 font-semibold rounded-lg hover:bg-slate-300">
                    Abbrechen
                </a>
            </div>
        {{ form_end(form) }}
    </div>
</section>
{% endblock %}
